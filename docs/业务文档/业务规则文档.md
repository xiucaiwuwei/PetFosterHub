# PetFosterHub 业务规则文档

## 1. 概述

本文档详细描述了PetFosterHub系统的业务规则和约束，包括用户管理、宠物管理、寄养服务、订单管理、支付结算、评价系统等各个模块的具体规则，为系统的业务逻辑实现提供规范和指导，也为毕业设计论文提供业务规则的详细说明。

## 2. 用户管理规则

### 2.1 用户注册规则

1. **注册信息完整性**：
   - 用户名、密码、邮箱（或手机号）为必填项
   - 用户名长度为3-20个字符，只能包含字母、数字和下划线
   - 密码长度至少8位，必须包含大小写字母、数字和特殊字符
   - 邮箱和手机号必须符合格式要求

2. **唯一性约束**：
   - 用户名、邮箱、手机号在系统中必须唯一
   - 不允许重复注册相同的用户信息

3. **角色选择**：
   - 用户注册时必须选择一种角色（宠物主人或寄养家庭）
   - 管理员角色只能由系统管理员手动创建

4. **注册验证**：
   - 新注册用户必须通过邮箱或手机验证码验证
   - 未验证用户只能使用部分功能

### 2.2 用户认证规则

1. **登录验证**：
   - 用户必须输入正确的用户名/邮箱/手机号和密码才能登录
   - 连续5次登录失败，账户将被锁定30分钟
   - 登录成功后生成JWT令牌，有效期为2小时

2. **密码策略**：
   - 密码加密存储，不可逆
   - 支持密码找回功能，通过邮箱或手机验证
   - 密码修改需要验证原密码

3. **会话管理**：
   - JWT令牌过期后需要重新登录
   - 支持多设备登录，新设备登录会顶掉旧设备的会话

### 2.3 用户信息管理规则

1. **信息修改**：
   - 用户可以修改头像、昵称、联系方式等个人信息
   - 用户名修改有次数限制（每30天最多修改1次）
   - 角色信息一旦确定，不可自行修改，需联系管理员

2. **实名认证**（预留）：
   - 寄养家庭必须完成实名认证才能发布寄养服务
   - 实名认证需提交身份证信息和照片
   - 认证信息需经过人工审核

3. **账户状态管理**：
   - 系统管理员可以禁用或启用用户账户
   - 违规用户账户将被禁用
   - 长期不活跃账户可能被系统提醒或清理

## 3. 宠物管理规则

### 3.1 宠物信息录入规则

1. **信息完整性**：
   - 宠物名称、类型、性别为必填项
   - 建议提供宠物照片、年龄、品种、体重等信息
   - 健康状况和特殊需求必须如实填写

2. **所有权约束**：
   - 用户只能添加和管理自己的宠物
   - 一个宠物只能属于一个主人
   - 宠物信息必须真实有效

### 3.2 宠物信息管理规则

1. **信息更新**：
   - 宠物主人可以随时更新宠物的基本信息
   - 宠物照片可以添加、修改和删除
   - 建议定期更新宠物的健康状况

2. **宠物删除**：
   - 宠物主人可以删除自己的宠物信息
   - 有未完成订单的宠物不允许删除
   - 删除宠物信息后，相关历史记录仍保留

## 4. 寄养服务规则

### 4.1 服务发布规则

1. **发布权限**：
   - 只有寄养家庭角色的用户可以发布寄养服务
   - 未完成实名认证的寄养家庭不能发布服务（预留）
   - 被限制的用户不能发布新服务

2. **服务信息完整性**：
   - 服务标题、描述、价格、地点、可服务时间、可接受宠物类型为必填项
   - 服务描述必须详细、真实，不得包含虚假信息
   - 服务价格必须合理，符合市场行情

3. **服务内容规范**：
   - 服务内容必须合法合规，不得包含违法信息
   - 不得发布歧视性、侮辱性或攻击性内容
   - 服务项目必须符合平台规定

### 4.2 服务管理规则

1. **服务状态管理**：
   - 服务状态包括：可预订（AVAILABLE）、已预订（BOOKED）、已关闭（CLOSED）
   - 寄养家庭可以手动关闭或重新开放服务
   - 服务时间结束后自动变为已关闭状态

2. **服务修改**：
   - 无未完成订单的服务可以自由修改所有信息
   - 有未完成订单的服务只能修改非关键信息（如描述、照片等）
   - 服务价格修改需提前通知已预订用户

3. **服务删除**：
   - 无未完成订单的服务可以删除
   - 有未完成订单的服务不允许删除
   - 删除服务后，相关历史记录仍保留

## 5. 订单管理规则

### 5.1 订单创建规则

1. **预订权限**：
   - 只有宠物主人角色的用户可以创建订单
   - 用户必须至少有一只已添加的宠物
   - 被限制的用户不能创建新订单

2. **服务可用性检查**：
   - 系统自动检查所选服务在预订时间段内是否可用
   - 检查服务容量是否已满
   - 检查宠物类型是否符合服务要求

3. **订单信息完整性**：
   - 服务ID、宠物ID、寄养开始时间、结束时间为必填项
   - 系统根据服务价格和寄养时长自动计算订单总价
   - 订单创建时必须关联有效的支付方式

### 5.2 订单状态流转规则

1. **状态定义**：
   - 待确认（PENDING）：订单创建成功，等待寄养家庭确认
   - 已确认（CONFIRMED）：寄养家庭确认订单，等待支付
   - 已支付（PAID）：用户完成支付，订单生效
   - 已完成（COMPLETED）：寄养服务完成
   - 已取消（CANCELLED）：订单被取消
   - 已拒绝（REJECTED）：寄养家庭拒绝订单

2. **状态流转路径**：
   - PENDING -> CONFIRMED/REJECTED
   - CONFIRMED -> PAID/CANCELLED
   - PAID -> COMPLETED/CANCELLED
   - REJECTED/CANCELLED/COMPLETED：终态，不可再变更

3. **状态变更规则**：
   - 待确认订单超过24小时未确认，自动取消
   - 已确认订单超过48小时未支付，自动取消
   - 服务开始前48小时内取消订单，收取订单金额的20%作为违约金
   - 服务开始前24小时内取消订单，收取订单金额的50%作为违约金
   - 服务开始后取消订单，不予退款

### 5.3 订单查询规则

1. **查询权限**：
   - 用户只能查询自己相关的订单
   - 宠物主人可以查询自己作为主人的订单
   - 寄养家庭可以查询自己作为服务提供方的订单
   - 管理员可以查询所有订单

2. **查询条件**：
   - 支持按订单状态、时间范围、宠物、服务等条件查询
   - 提供订单搜索功能

## 6. 支付结算规则

### 6.1 支付规则

1. **支付方式**：
   - 支持微信支付、支付宝支付等主流在线支付方式
   - 支持余额支付（预留）
   - 不支持线下现金支付

2. **支付时机**：
   - 订单确认后才能进行支付
   - 支付必须在订单确认后的48小时内完成
   - 超时未支付的订单将自动取消

3. **支付安全**：
   - 所有支付交易必须通过加密通道进行
   - 支付信息不存储在系统中，仅保留交易流水号
   - 支付结果必须通过异步回调机制确认

### 6.2 结算规则

1. **结算周期**：
   - 寄养服务完成并评价后进行结算
   - 平台与寄养家庭的结算周期为T+7（交易完成后7天）
   - 结算周期可根据平台政策调整

2. **费用分成**：
   - 平台收取服务费用的10%-20%作为服务费
   - 具体分成比例可根据服务类型和合作模式调整
   - 平台服务费包含支付通道费、技术服务费等

3. **提现规则**（预留）：
   - 寄养家庭可申请提现结算金额
   - 提现需绑定有效的银行卡或支付账户
   - 提现金额有最低限制（如100元）
   - 提现申请需经过审核，审核通过后1-3个工作日到账

### 6.3 退款规则

1. **退款条件**：
   - 订单取消时根据取消时间和原因确定退款比例
   - 服务未按约定提供或存在质量问题时可申请退款
   - 退款申请需在服务结束后7天内提出

2. **退款流程**：
   - 用户提交退款申请并说明原因
   - 系统或管理员审核退款申请
   - 审核通过后，退款金额按原支付路径退回
   - 退款到账时间取决于支付方式，一般为1-7个工作日

3. **退款金额计算**：
   - 全额退款：退还用户实际支付的全部金额
   - 部分退款：根据退款政策计算退款金额，扣除相应费用

## 7. 评价系统规则

### 7.1 评价提交规则

1. **评价权限**：
   - 只有参与订单的宠物主人和寄养家庭可以互相评价
   - 评价必须在服务完成后的14天内提交
   - 超过期限未评价的用户将被系统自动默认好评

2. **评价内容规范**：
   - 评价内容必须真实、客观，不得包含虚假信息
   - 不得发布违法、违规、侮辱性或攻击性内容
   - 评价内容将经过系统过滤和人工审核

3. **评分标准**：
   - 评分采用5星制，1星最差，5星最好
   - 评分维度包括服务质量、沟通及时性、环境条件等（预留）
   - 系统根据评分计算用户和服务的平均评分

### 7.2 评价管理规则

1. **评价展示**：
   - 评价内容和评分将公开展示在服务详情页和用户个人主页
   - 评价内容不可修改，但可以删除
   - 用户可以对评价进行回复

2. **评价删除**：
   - 用户可以删除自己提交的评价
   - 包含违规内容的评价将被系统或管理员删除
   - 删除评价后，相应的评分也将从平均评分中移除

3. **争议处理**：
   - 对于不实评价，用户可以提交申诉
   - 管理员将根据实际情况进行调查和处理
   - 恶意评价者将受到平台处罚

## 8. 消息通信规则

### 8.1 消息发送规则

1. **发送权限**：
   - 用户只能向有业务关联的用户发送消息
   - 宠物主人和寄养家庭可以在订单相关的会话中通信
   - 不允许发送骚扰性或垃圾消息

2. **消息内容规范**：
   - 消息内容必须合法合规
   - 不得发送广告、诈骗、色情、暴力等违法信息
   - 系统对消息内容进行过滤

### 8.2 消息接收规则

1. **消息通知**：
   - 新消息通过站内信、邮件或短信通知用户
   - 支持消息推送功能
   - 重要通知（如订单状态变更）将通过多种渠道通知用户

2. **消息存储**：
   - 所有消息记录保存在系统中，便于用户查阅
   - 消息记录长期保存，但用户可以删除本地消息
   - 系统定期清理过期的不重要消息

## 9. 数据规则

### 9.1 数据存储规则

1. **数据安全**：
   - 所有用户敏感数据必须加密存储
   - 数据传输必须使用SSL/TLS加密
   - 定期进行数据备份

2. **数据保留**：
   - 用户数据在账户注销后保留一定期限（如3年）
   - 订单和支付记录长期保存
   - 日志数据保存一定期限（如6个月）后可归档或删除

### 9.2 数据访问规则

1. **访问权限**：
   - 用户只能访问自己的数据
   - 管理员根据权限级别访问相应数据
   - 所有数据访问必须记录日志

2. **数据脱敏**：
   - 敏感数据在展示时必须进行脱敏处理
   - 如手机号、邮箱、身份证号等
   - 内部系统使用时也需遵循最小权限原则

## 10. 系统管理规则

### 10.1 管理员权限规则

1. **权限分级**：
   - 系统管理员：拥有最高权限，可以管理所有系统资源
   - 运营管理员：负责用户管理、内容审核等运营工作
   - 客服管理员：负责处理用户咨询和投诉

2. **操作审计**：
   - 管理员的所有关键操作必须记录审计日志
   - 审计日志包括操作人、操作时间、操作内容、IP地址等信息
   - 审计日志长期保存，便于追溯和调查

### 10.2 系统维护规则

1. **定期维护**：
   - 系统定期进行维护和升级
   - 维护时间提前通知用户
   - 维护期间可能暂停部分或全部服务

2. **故障处理**：
   - 系统出现故障时，技术人员立即进行排查和修复
   - 重大故障及时通知用户，并说明预计恢复时间
   - 故障处理过程和结果记录在案

## 11. 附则

1. **规则更新**：
   - 平台有权根据业务发展和运营需要更新业务规则
   - 规则更新后将通过系统公告、邮件等方式通知用户
   - 用户继续使用平台服务视为接受新规则

2. **违规处理**：
   - 违反业务规则的用户将根据情节轻重受到警告、限制功能、账户冻结等处罚
   - 严重违规的用户将被永久封禁
   - 违规行为涉及违法的，将依法追究法律责任

3. **最终解释权**：
   - 本业务规则的最终解释权归PetFosterHub平台所有
   - 如有疑问，可联系平台客服咨询

通过以上业务规则的制定和执行，PetFosterHub系统能够规范业务行为，保障用户权益，维护平台秩序，为用户提供安全、可靠、便捷的宠物寄养服务体验。